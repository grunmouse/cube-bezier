# Пересечение двух кубических кривых Безье

Пусть кривые заданы полиномами
$$
\left\{
\begin{gathered}
x_1 = A_1t_1^3+A_2t_1^2+A_3t_1 + A_4, \\
y_1 = B_1t_1^3+B_2t_1^2+B_3t_1 + B_4.
\end{gathered}
\right.
$$
$$
\left\{
\begin{gathered}
x_2 = C_1t_2^3+C_2t_2^2+C_3t_2 + C_4, \\
y_2 = D_1t_2^3+D_2t_2^2+D_3t_2 + D_4.
\end{gathered}
\right.
$$

Получим систему уравнений

$$
\left\{
\begin{gathered}
A_1t_1^3+A_2t_1^2+A_3t_1 + A_4 = C_1t_2^3+C_2t_2^2+C_3t_2 + C_4, \\
B_1t_1^3+B_2t_1^2+B_3t_1 + B_4 = D_1t_2^3+D_2t_2^2+D_3t_2 + D_4;
\end{gathered}
\right.
$$

$$
\left\{
\begin{gathered}
A_1t_1^3+A_2t_1^2+A_3t_1 + A_4 - C_1t_2^3-C_2t_2^2-C_3t_2 - C_4 =0, \\
B_1t_1^3+B_2t_1^2+B_3t_1 + B_4 - D_1t_2^3-D_2t_2^2-D_3t_2 - D_4 =0.
\end{gathered}
\right.
$$

Применим теорию вычетов.

Обозначим
$$
\begin{gathered}
A_0 = A_4 - C_1t_2^3-C_2t_2^2-C_3t_2 - C_4 =0, \\
B_0 = B_4 - D_1t_2^3-D_2t_2^2-D_3t_2 - D_4 =0;
\end{gathered}
$$

тогда

$$
\left\{
\begin{gathered}
A_1t_1^3+A_2t_1^2+A_3t_1 + A_0 =0, \\
B_1t_1^3+B_2t_1^2+B_3t_1 + B_0 =0.
\end{gathered}
\right.
$$

Введём полиномы
$$
\left\{
\begin{gathered}
f(t_1) = A_1t_1^3+A_2t_1^2+A_3t_1 + A_0 =0, \\
g(t_1) = B_1t_1^3+B_2t_1^2+B_3t_1 + B_0 =0;
\end{gathered}
\right.
$$

и составим матрицу Сильвестера

$$
S(f, g) = \begin{pmatrix}
A_1 & A_2 & A_3 & A_0 & 0 & 0\\
0 & A_1 & A_2 & A_3 & A_0 & 0\\ 
0 & 0 & A_1 & A_2 & A_3 & A_0\\
B_1 & B_2 & B_3 & B_0 & 0 & 0\\
0 & B_1 & B_2 & B_3 & B_0 & 0\\ 
0 & 0 & B_1 & B_2 & B_3 & B_0
\end{pmatrix}.
$$

Миноры, состоящие из первых трёх столбцов - константные.
Их будем обозначать $M$ или $\bar M$, с тремя индексами, где черта обозначает дополнительный минор. Индексы для $M$ будут обозначать включённые строки, а для $\bar M$ - исключённые.


У нас получилось много констант. Ведём для них обозначения.
Пусть
$$\det S(f,g) = \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j}A_0^{i-j}B_0^{j};$$
$$
\begin{gathered}
K_{3,0} = -\bar{M}_{1,2,3},\\
K_{2,1} = -\left( \bar{M}_{1,3,5} - \bar{M}_{2,3,4} + \bar{M}_{1,2,6} \right),\\
K_{1,2} = \bar{M}_{2,4,6} - \bar{M}_{1,5,6} - \bar{M}_{3,4,5},\\
K_{0,3} = \bar{M}_{4,5,6},\\
K_{2,0} = - \left( B_3 \bar{M}_{2,3,5}-B_2 \bar{M}_{2,3,6} - B_3 \bar{M}_{1,3,6} \right),\\
K_{1,1} = A_3 \bar{M}_{2,3,5}+B_2 \bar{M}_{3,5,6} + B_3 \bar{M}_{3,4,6} -A_2 \bar{M}_{2,3,6} -B_3 \bar{M}_{2,5,6} - A_3 \bar{M}_{1,3,6}, \\
K_{0,2} = A_3 \bar{M}_{2,5,6}-A_2 \bar{M}_{3,5,6} - A_3 \bar{M}_{3,4,6} , \\
K_{1,0} = - B_3 \left(A_3 \bar{M}_{2,3,6}+B_3 \bar{M}_{3,5,6}\right),\\
K_{0,1} = A_3 \left( A_3 \bar{M}_{2,3,6}+B_3 \bar{M}_{3,5,6}\right).\\
\end{gathered}
$$
Подставим миноры, с учётом их взаимозависимостей
$$
\begin{gathered}
K_{3,0} = - M_{4,5,6},\\
K_{2,1} = -\left( -M_{3,4,5} - M_{3,4,5} + M_{3,4,5} \right)
 = M_{3,4,5},\\
K_{1,2} = -M_{2,3,4} - M_{2,3,4} - M_{2,3,4} = -3 M_{2,3,4},\\
K_{0,3} = M_{1,2,3},\\
K_{2,0} = - \left( B_3 M_{1,4,6}- B_2 M_{1,4,5} + B_3 M_{1,4,6} \right)
= - 2 B_3 M_{1,4,6} + B_2 M_{1,4,5},\\
K_{1,1} =  A_3 M_{1,4,6}+B_2 M_{1,2,4} + B_3 M_{1,2,5} -A_2 M_{1,4,5} +B_3 M_{1,2,5} + A_3 M_{1,4,6}
 =
-A_2 M_{1,4,5} 
+2 A_3 M_{1,4,6}
+B_2 M_{1,2,4} 
+2 B_3 M_{1,2,5} 
, \\
K_{0,2} = - A_3 M_{1,2,5} - A_2 M_{1,2,4} - A_3 M_{1,2,5} = - A_2 M_{1,2,4} - 2 A_3 M_{1,2,5} , \\
K_{1,0} = - B_3 \left( A_3 M_{1,4,5} + B_3 M_{1,2,4} \right),\\
K_{0,1} = A_3 \left( A_3 M_{1,4,5} + B_3 M_{1,2,4} \right).\\
\end{gathered}
$$

### Произведения и степени полиномов $A_0$ $B_0$

$$
\begin{gathered}
A_0 = A_4 - C_4 - C_1 t_2^3 - C_2 t_2^2 - C_3 t_2, \\
B_0 = B_4 - D_4 - D_1 t_2^3 - D_2 t_2^2 - D_3 t_2;
\end{gathered}
$$

Обозначим коэффициенты при степенях многочлена
Первый индекс будет обозначать степень участия $A_0$, второй - $B_0$, а третий - степен $t_2$ в итоговом многочлене
$$\begin{gathered}
P_{1,0,0} = A_4 - C_4,\\
P_{1,0,1} = -C_3,\\
P_{1,0,2} = -C_2,\\
P_{1,0,3} = -C_1,\\
P_{0,1,0} = B_4 - D_4,\\
P_{0,1,1} = -D_3,\\
P_{0,1,2} = -D_2,\\
P_{0,1,3} = -D_1;
\end{gathered}$$

При умножении многочленов каждая пара коэффициентов перемножаясь будет порождать
$$P_{a_1,b_1,i_1}P_{a_2,b_2,i_2} = Q_{a_1+a_2,b_1+b_2,i_1,i_2};$$
Причём коэффициенты порождаемого многочлена будут суммами
$$P_{a,b,i} = \sum_{j=0}^{i} Q_{a,b,i-j,j}$$

Так как $t$ участвует в $A_0$ и $B_0$ в третьей степени, то $i \in [0, 3(a+b)]$.

Тогда произведение многочленов примет вид

$$A_0^aB_0^b = \sum{i=0}{3(a+b)} P_{a,b,i} t^i.$$

При подстановке $A_0$ и $B_0$ в $\det S$ получится

$$\det S(f,g) 
= \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} A_0^{i-j}B_0^{j}
= \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} \sum_{k=0}^{3i} P_{i-j,j,k} t^k
= \sum_{i=1}^3 \sum_{j=0}^{i} \sum_{k=0}^{3i} K_{i-j,j} P_{i-j,j,k} t^k
= \sum_{i=1}^3 \sum_{k=0}^{3i} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,k} t^k
;$$

$$\sum_{k=0}^{3i} a_k = a_0 + \sum_{k'=1}^{i} \sum_{l=0}^{2} a_{3k'-l};$$

$$\sum_{k=0}^{3i} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,k} t^k
= \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0} t^0 + \sum_{k'=1}^{i} \sum_{l=0}^{2} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l} t^{3k'-l}
;$$

$$\det S(f,g)
= \sum_{i=1}^3 \sum_{k=0}^{3i} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,k} t^k
= \sum_{i=1}^3 \left(\sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0} t^0 + \sum_{k'=1}^{i} \sum_{l=0}^{2} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l} t^{3k'-l} \right);
$$

$$\det S(f,g)
= \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0} t^0 
+\sum_{i=1}^3 \sum_{k'=1}^{i} \sum_{l=0}^{2} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l} t^{3k'-l};
$$
$$\det S(f,g)
= t^0 \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0} 
+\sum_{l=0}^{2} \sum_{i=1}^3 \sum_{k'=1}^{i} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l} t^{3k'-l};
$$

$$
\sum_{i=1}^3 \sum_{k'=1}^{i} a_{i,k'}
= \sum_{k'=1}^{3} \sum_{i=k'}^{3} a_{i,k'};
$$

$$\det S(f,g)
= t^0 \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0} 
+\sum_{l=0}^{2} \sum_{k'=1}^{3} \sum_{i=k'}^{3} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l} t^{3k'-l};
$$
$$\det S(f,g)
= t^0 \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0} 
+\sum_{l=0}^{2} \sum_{k'=1}^{3} t^{3k'-l} \sum_{i=k'}^{3} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l};
$$

Выпишем коэффициенты при степенях t

$$S_0 = \sum_{i=1}^3 \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,0};$$
$$S_{3k'-l} = \sum_{i=k'}^{3} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,3k'-l};$$
$$S_{k} = \sum_{i=\lceil \frac{k}{3} \rceil}^{3} \sum_{j=0}^{i} K_{i-j,j} P_{i-j,j,k};$$